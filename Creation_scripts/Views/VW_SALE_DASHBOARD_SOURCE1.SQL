create or replace view DEALERSHIPS.MART_CAROBAR.VW_SALE_DASHBOARD_SOURCE1(
	DEALER_ID,
	SUBDEALER_ID,
	CAR_VERSION_ID,
	CAR_ID,
	CAR_TYPE,
	SELL_PRICE,
	COST_PER_CAR,
	SALE_DATE,
	ARRIVAL_DATE,
	CITY,
	STATE,
	AC_VENT,
	ALLOY_WHEEL,
	AUTOMATIC_CLIMATE_CONTROL,
	CENTRAL_LOCK,
	CHILD_LOCK_SAFETY,
	COLORS,
	CRUISE_CONTROL,
	FOG_LIGHTS,
	KEY_LESS_ENTRY,
	PARKING_SENSOR,
	POWER_STEERING,
	REAR_CAMERA,
	SUNROOF,
	AUDIOSYSTEM,
	BODY_TYPE,
	BRAND,
	CHILD_SAFETY_LOCKS,
	CITY_MILEAGE,
	DISPLACEMENT,
	DOORS,
	DRIVETRAIN,
	ENGINE_LOCATION,
	FRONT_BRAKES,
	FUEL_GAUGE,
	FUEL_LID_OPENER,
	FUEL_SYSTEM,
	FUEL_TANK_CAPACITY,
	FUEL_TYPE,
	GEARS,
	GROUND_CLEARANCE,
	HANDBRAKE,
	HEIGHT,
	HIGHWAY_MILEAGE,
	LENGTH,
	MODEL,
	POWER,
	POWER_WINDOWS,
	REAR_BRAKES,
	SEATING_CAPACITY,
	SEATS_MATERIAL,
	SHOWROOM_PRICE,
	SPEEDOMETER,
	STATE_CODE,
	TACHOMETER,
	TORQUE,
	VARIANT,
	WHEELBASE,
	WIDTH,
	USED_CAR_KILOMETERS,
	YEAR,
	EMP_ID,
	EMP_COMMISSION,
	EMP_LNAME,
	CUSTOMER_ID,
	CUSTOMER_AGE,
	AVG_AGED_SELL_PRICE,
	AVG_AGED_COST_PER_CAR,
	SALE_COUNT,
	TOTAL_CARS,
	AVG_SELL_PRICE,
	AVG_COST_PER_CAR,
	TOTAL_SELL_PRICE,
	TOTAL_COST_PER_CAR,
	AVG_USED_CAR_KILOMETERS,
	AVG_REMAINING_STOCK,
	STOCK_NEEDED,
	AVG_DAYS_SINCE_ARRIVAL,
	AVG_DAYS_UNTIL_SOLD,
	STOCK_METRIC,
	MONTHLY_STOCKED,
	MONTHLY_SOLD,
	AGE_RANGE,
	CUSTOMER_SEX,
	CUSTOMER_COUNT,
	CAR_AGE_RANGE,
	ROW_NUM
) WITH ROW ACCESS POLICY DEALERSHIPS.MART_CAROBAR.DEALER_ROLE_POLICY ON (DEALER_ID)
 as(
SELECT * FROM ( SELECT *, ROW_NUMBER() OVER( PARTITION BY car_id ORDER BY CAR_ID) AS row_num FROM vw_sale_dashboard_source) subquery where row_num=1);